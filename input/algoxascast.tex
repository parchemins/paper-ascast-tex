
\SetInd{0.2em}{0.8em}

\newcommand{\algoAnd}{~\textbf{\textup{and}}~}
\newcommand{\algoOr}{~\textbf{\textup{or}}~}

\SetKwProg{Function}{func}{}{}

\small

\DontPrintSemicolon
\LinesNumbered

\newcommand{\XADD}{\Gamma}
\newcommand{\xadd}{\gamma}

$X_p$ \tcp*[r]{neighbors in a different network}
$\XADD_{\pi}^{d} \leftarrow \gamma_{\varnothing}^{\infty} $
\tcp*[r]{best $\gamma$ so far (\underline{g}lobal $\alpha$)}

\BlankLine

%% \begin{multicols}{2}
%% \Function{\textup{\texttt{Add( )}}} { % \hfill [if $V[p]\equiv 0 \mod 2 $]} } {
%%   $V[p] \leftarrow V[p] + 1$ \;
%%   \textup{\smash{receiveAdd($p$, $\alpha_{\varnothing}^{0}$)}}\label{line:ascast_add}
%% }


%% \Function{\textup{\texttt{Del( )}}} { % \hfill [if $V[p]\equiv 1 \mod 2 $]} } {
%%   $V[p] \leftarrow V[p] + 1$ \;
%%   \textup{\smash{receiveDel($p$, $\delta_{p, V[p]}$)}}\label{line:ascast_del}
%% }
%% \end{multicols}



% \begin{multicols}{2}

\Function{\textup{receiveAdd($q$, $\alpha_{\pi'}^{d'}$)}} {
  \If {$m \in \xadd \vee q \in X_p$}{
    receiveXAdd($q$, $m$)
  } \Else {
    receiveLAdd($q$, $m$)
  }
}

\BlankLine

\Function{\textup{receiveLAdd($q$, $\alpha_{\pi'}^{d'}$)}} {
  \uIf {\smash{$\alpha_{\pi'}^{d'} < A_{\pi}^{d} \algoAnd \neg\textup{isStale}(\alpha_{\pi'}^{d'}) \algoAnd \neg\textup{isLoop}(\alpha_{\pi'}^{d'})$\label{line:ascast_improve}}} {
    $\smash{A_{\pi}^{d} \leftarrow \alpha_{\pi' \cup \langle p, V[p] \rangle}^{d'}}$ \;
    \lForEach{$n \in O_p$} {
      send$_n$(\smash{$\alpha_{\pi}^{d + w_{pn}}$})
    }
  }
  \uElseIf{$\textup{isParent}(q) \algoAnd \textup{isStale}(\alpha_{\pi'}^{d'})$\label{line:ascast_detect}} {
    \textup{receiveDel($q$, $\delta_{p, V[p] + 1}$)}
  }

  updateVersions($\pi'$) \;
}



\BlankLine

\Function{\textup{receiveXAdd($q$, x$\alpha_{\pi'}^{d'}$)}} {
  
}




\BlankLine

\Function{\textup{receiveDel($q$, $\delta_{s, c}$)}} {
  \uIf {$\exists \langle s, c' \rangle \in \pi: c' < c$\label{line:ascast_delete}} {
    $\smash{A^d_\pi \leftarrow \alpha^\infty_\varnothing}$ \;
    \lForEach {$n \in O_p \setminus q$}{send$_n$($\delta_{s, c}$)}
  }
  \lElseIf {$A_s^d \neq \alpha^\infty_\varnothing$} {
    send$_q$($\alpha_\pi^{d + w_{pq}}$)\label{line:ascast_echo}
  }

  updateVersions($[\langle s, c \rangle]$)
}

% \end{multicols}

\BlankLine

\footnotesize\lFunction{\textup{fromX($q$, $\alpha_{\pi'}^{d'}$)}} {
  %% ugly if then else but w/e
  \textbf{if} $q \in X_p$ \textbf{then} {\Return x\smash{$\alpha_{\pi'}^{d'}$} \textbf{else}
    \Return \smash{$\alpha_{\pi'}^{d'}$}}
}

%%% Local Variables: 
%%% mode: latex
%%% TeX-master: "../paper"
%%% ispell-local-dictionary: "english"
%%% End: 
